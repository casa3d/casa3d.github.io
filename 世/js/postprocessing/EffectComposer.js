T.EffectComposer=function(e,r){if(this.renderer=e,void 0===r){var t=window.innerWidth||1,s=window.innerHeight||1,i={minFilter:T.LinearFilter,magFilter:T.LinearFilter,format:T.RGBFormat,stencilBuffer:!1};r=new T.WebGLRenderTarget(t,s,i)}this.renderTarget1=r,this.renderTarget2=r.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===T.CopyShader&&console.error("T.EffectComposer relies on T.CopyShader"),this.copyPass=new T.ShaderPass(T.CopyShader)},T.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},insertPass:function(e,r){this.passes.splice(r,0,e)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var r,t,s=!1,i=this.passes.length;for(t=0;i>t;t++)if(r=this.passes[t],r.enabled){if(r.render(this.renderer,this.writeBuffer,this.readBuffer,e,s),r.needsSwap){if(s){var n=this.renderer.context;n.stencilFunc(n.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),n.stencilFunc(n.EQUAL,1,4294967295)}this.swapBuffers()}r instanceof T.MaskPass?s=!0:r instanceof T.ClearMaskPass&&(s=!1)}},reset:function(e){void 0===e&&(e=this.renderTarget1.clone(),e.width=window.innerWidth,e.height=window.innerHeight),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,r){var t=this.renderTarget1.clone();t.width=e,t.height=r,this.reset(t)}},T.EffectComposer.camera=new T.OrthographicCamera(-1,1,1,-1,0,1),T.EffectComposer.quad=new T.Mesh(new T.PlaneGeometry(2,2),null),T.EffectComposer.scene=new T.Scene,T.EffectComposer.scene.add(T.EffectComposer.quad)