o={a:$('<a>')[0],d:document,w:window,W:innerWidth/100,l0p:innerHeight/10,ap:'application/',fs:'FullScreen',house:[],of:'house brick door glass wall window wood'.split(' '),m:new T.MeshBasicMaterial,ob3:new T.Object3D,sty:'canvas{left:0;position:fixed;top:0;',S:510,Π:Math.PI,π:Math.PI/2,pl:function(o,t){return new T.PlaneGeometry(o,t)},URL:function(o){return URL.createObjectURL(o)},tn:{blob:{}},tdp:function(o,t){return{curveSegments:1,font:'janda manatee solid',height:o,size:t}},usrAgnt:{Chrome:'webkit',Trident:'ms',Firefox:'moz'},Δ:[],clear:function(o,t,e){setTimeout(function(){clearInterval(o),i.c(t+"-clock's renderer has been cleared"),console.clear()},e)},rb:function(t){for(var e,n,i,s=0;s<t.length;){n=1,e=t[s++];for(var r in o.tn.blob)if(o.tn.blob[r].sz==e.size&&!(n=0))break;o.add(o.φ=n?o.URL(e):r,1,e.size)}i=setInterval(o.R,100),o.clear(i,'image-click',500)},ad:function(e,n){var i=c.position;t.ad({a:'1 2['+(n?e:e.split(/img\/(.*)/)[1])+']'+(i.x/100).toFixed(0)+' '+(i.y+(/1|2|4/.test(o.txt.r.idx)?0:-90))/100+' '+(i.z-150).toFixed(1)/100+' '+o.txt.r[o.txt.r.idx]}),c.position.y+=.1,c.position.z+=.1},add:function(t,e,n){var i,s,r,a,l,p;i=o.tx,t!=o.tx&&(o.txt.r.idx=o.o.parent.id-o.st.rll.children[0].id),o.ad(o.tx=(e&&36==t.length?'blob:http%3A//localhost%3A3000/':'')+t,e),e&&36!=t.length&&(t=t.substr(31,t.length-1)),p=o.tn[t]||o.tn.blob[t],p?(o.tn.o=o.tns.children[p.id],o.txt.get(++p.x+'')):(e?o.tn.blob[t]={id:o.tns.children.length,sz:n,x:1}:o.tn[t]={id:o.tns.children.length,x:1},s=o.pl(o.gw,o.gh),φ=e?T.ImageUtils.loadTexture(o.tx):o.o.material.map,r=o.m.clone(),r.map=φ,o.tns.add(a=new T.Mesh(s,r)),a.position.x=-o.gw*(49-(l=o.tns.children.length))+o.gw/2,a.N=[],l>9&&(o.tns.position.x-=o.gw),o.txt.init(a,0),o.tns.right-=o.gw)},cc:function(){var e=t.s.__lights[0].color;o.o.il?e.b<1&&(e.b+=.15):e.b>.1&&(e.b-=.15),e.r=e.g=e.b},ld:function(o){alert(o||'100% ?')},dwn:function(t){o.a.download='casa#'+t+' ('+(new Date).toUTCString().split(/, | GMT/)[1]+').zip',navigator.msSaveBlob?navigator.msSaveBlob(blb,o.a.download):(clickEvent=o.d.createEvent('MouseEvent'),clickEvent.initMouseEvent('click',1,1,o.w,0,0,0,0,0,0,0,0,0,0,null),o.a.dispatchEvent(clickEvent))},zip:function(){if(zip&&zip.useWebWorkers){var t=o.o.material.color;return t.r=t.g=t.b=1,o.o=o.menu,1}},exp:function(){if(o.zip())if(o.house.length){var t,e=((c.position.x+o.S/2)/o.S+1+'')[0];e=e>0?e:1,t=new Blob([o.house[e-1]],{type:o.ap+'javascript'}),t.name='casa3d.js',zip.createWriter(new zip.BlobWriter(o.ap+'zip'),function(n){zipWriter=n,zipWriter.add(t.name,new zip.BlobReader(t),function(){o.a.hidden=0,zipWriter.close(function(t){o.a.href=o.URL(blb=t),o.dwn(e)})})})}else o.ld(o.fi);else o.ld()},cl:function(t){return o.menu.children[t].material.color},ntH:function(l,ch){var s=o.S*l,p,n;t.ad({a:eval(ch),p:p=o.ob3.clone(),gp:t.s}),c.position.set(p.position.x=s,1e3,1700),c.rotation.set(0,0,0),h.ntH.add(n=new T.Mesh(new T.TextGeometry(l+1,o.tdp(1,100)),o.m)),n.position.x=s-(l>8?30:0),o.house[l]=ch},imp:function(t){if(t&&o.zip()){var e=t[0];zip.createReader(new zip.BlobReader(e),function(t){t.getEntries(function(t){(E=t=t[0])&&t.getData(new zip.BlobWriter,function(t){fr=new FileReader,fr.onload=function(){o.ntH(h.ntH.children.length,this.result)},fr.readAsText(t)},null)})})}else o.ld()},mv:function(){o.st.rll.position.x+=o.o.id==o.left.id&&o.st.rll.position.x<o.left.lim?o.pnlW:o.o.id==o.right.id&&o.st.rll.position.x>o.right.lim&&-o.pnlW},R:function(){o.r.render(o.s,o.c)},how:function(){var t,e,n,i,s,r;o.kb?o.kb.position.z=o.kb.position.z?0:-1:(t=o.pl(o.W,o.H),e=new T.MeshLambertMaterial,o.s.add(o.kb=new T.Mesh(t,ma=e.clone())),ma.transparent=1,ma.opacity=.5,t=o.pl(),o.kb.add(i=new T.Mesh(t,e)),o.kb.add(s=i.clone()),i.add(james=new T.Mesh(t=o.pl(o.gw,o.gh),e)),i.add(n=james.clone()),i.position.set(3*-o.gw,-o.gh,0),s.position.set(2*o.gw,-o.gh,0),n.position.y=-o.gh/1.9,t=new T.CylinderGeometry(0,.2,.2),e=new T.MeshBasicMaterial,james.add(new T.Mesh(t,e)),t=new T.TextGeometry('ctrl',o.tdp(1e-6,.2)),n.add(r=new T.Mesh(t,e)),r.position.x=-o.gw/5,s.add(n=james.clone()),n.position.y=o.gh/1.9,s.add(n=james.clone()),n.position.x=o.gw/1.3,n.rotateZ(-o.π),s.add(n=james.clone()),n.position.y=-o.gh/1.9,n.rotateZ(o.Π),s.add(n=james.clone()),n.position.x=-o.gw/1.3,n.rotateZ(o.π),james.position.y=o.gh/1.9)},st:{app:!1,init:function(t){var e,n,i,s,r,a=0,l=[[],[]],p=[[],[]];l[0][3]=-(l[0][0]=3*(l[0][1]=-(l[0][2]=o.gw))),p[0][0]=-(p[0][3]=3*(p[0][2]=-(p[0][1]=o.gh))),l[1][0]=-(l[1][3]=.0123),l[1][1]=p[1][2]=-(l[1][2]=p[1][1]=.00498),p[1][3]=-(p[1][0]=.0085),o.pnlW=o.W-2*o.gw,o.pnlH=o.H-2*o.gh,e=o.pl(o.W,o.pnlH),n=new T.MeshLambertMaterial({opacity:0,transparent:!0,visible:!1}),o.s.add(o.st.pnl=new T.Mesh(e,n)),o.shwm(),o.st.pnl.c=1,e=o.pl(o.pnlW*o.of.length,o.pnlH),o.st.pnl.add(r=o.st.rll=new T.Mesh(e,n)),r.position.set(r.geometry.width/2-o.pnlW,0,1e-4),e=o.pl(o.pnlW,o.pnlH);for(a in o.of){var c=0;n=new T.MeshBasicMaterial({visible:!1}),r.add(i=new T.Mesh(e,n)),i.position.x=3*-o.pnlW+o.pnlW/2+o.pnlW*a,i.c=1}o.f=r.children[0].id,o.l=r.children[o.of.length-1].id,e=o.pl(2*o.gw,2*o.gh);for(a in o.of)for(var c=0;4>c;){var d=1,h=4*c,m=o.of[a];for(s=new T.ImageUtils.loadTexture('img/'+m+'/'+('house'==m?0:h)+'.jpg'),n=new T.MeshBasicMaterial({map:s,opacity:.85,transparent:!0}),r.children[a].add(i=new T.Mesh(e,n)),i.position.set(l[0][c]+l[1][c],p[0][0]+p[1][0],0);4>d;)s=new T.ImageUtils.loadTexture('img/'+m+'/'+('house'==m?0:d+h)+'.jpg'),n=new T.MeshBasicMaterial({map:s,opacity:.85,transparent:!0}),r.children[a].add(i=new T.Mesh(e,n)),i.position.set(l[0][c]+l[1][c],p[0][d]+p[1][d],0),d++;c++}e=o.pl(o.gw,o.pnlH),s=new T.ImageUtils.loadTexture('img/icon/left.png'),n=new T.MeshBasicMaterial({map:s,opacity:.3,transparent:!0,blending:0,color:'lightgrey'}),o.st.pnl.add(o.left=new T.Mesh(e,n)),o.left.position.set(t,0,.001),o.left.lim=27,o.st.pnl.add(o.right=o.left.clone()),o.right.rotation.z=o.Π,o.right.position.set(-t,0,.001),o.right.lim=-38}},s:new T.Scene,c:new T.PerspectiveCamera(innerHeight/(768/42),innerWidth/innerHeight,.001,10),r:new T.WebGLRenderer,pj:new T.Projector,V3:new T.Vector3(0,0,.5),o:{id:''},kbd:function(){o.kb&&!o.kb.position.z&&(o.kb.position.z=-1)},shwm:function(){o.st.pnl.position.y=o.st.pnl.position.y?(m.rKey&&m.act(),0):o.H,o.kbd()},ops:[0,0,0,function(){var t,e,n,i=o.menu.children;t=o.menu.rotation.z?[4.3*(n=1)*o.gw,0,0]:[0,(n=-1)*o.H/2+1.1*o.gh,o.π],o.menu.rotation.z=t[2],o.menu.position.set(t[0],t[1],0);for(e in i)i[e].rotateZ(n*o.π)},0,function(){o.in.click()},dr.act,dr.act,m.rt,function(){m.rt(2)},0,0,m.act,function(){o.d[o.is]?o.d[o.ex]():o.d.body[o.rq]()},0,function(){o.im.click()},function(){open(location.href+'support','_new')},function(){u.cl(),u.out(),u.shift(),setTimeout(u.cl,500)}],rc:function(t){o.V3.x=2*(t.clientX/o.w.innerWidth)-1,o.V3.y=2*-(o.y/o.w.innerHeight)+1,o.pj.unprojectVector(o.V3,o.c),o.rC=new T.Raycaster(o.c.position,o.V3.sub(o.c.position).normalize()),o.rst=o.rC.intersectObjects(o.s.children,!0);for(var e in o.rst)if(o.rst[e].object.parent.c)return o.rst=o.rst[e];return o.rst=o.rst[0]},slide:function(){var t,e,n;o.app&&(e=o.tns,n=e.position.x,((t=o.x&&n>e.right)||!o.x&&n<e.left)&&(e.position.x-=t?.05:-.05,requestAnimationFrame(o.slide),o.R()))},at:function(){return o.o.parent.id==o.tn.id||o.o.parent.id>=o.f&&o.o.parent.id<=o.l},txt:{init:function(t,e){for(var n;10>e;)t.N[e]=[n=new T.Mesh(new T.TextGeometry(e++,o.tdp(1e-6,.2)),o.m)],n.position.x=-.65,n.position.y=.4,t.add(n)},hd:function(t,e){var n=t.length-1,i=o.tn.o.N[t[e=e?n-e:n]][e];i&&.4!=i.position.y&&(i.position.y=.4)},mv:function(t,e){var n=t.length-1,i=o.tn.o,s=i.N[t[e=e?n-e:n]];obj=s[e],!obj&&i.add(obj=s[e]=s[0].clone()),obj.position.set(o.Δ[e],.09,0)},lm:[],it:function(t,e,n){0==t[n-e]&&(o.txt.mv(t,e),t>o.txt.lm[e]&&(o.txt.hd(t-1+'',e),o.txt.it(t,e+1,n)))},get:function(t){o.txt.mv(t),o.txt.it(t,1,t.length),o.txt.hd(t-1+'')},r:'p  p p'.split(/|/)},init:function(){function t(t){i=new T.ImageUtils.loadTexture('img/icon/menu.png'),i.repeat.y=.0625,i.offset.y=.0625*(2*p+t),n=new T.MeshBasicMaterial({map:i,transparent:1}),s=new T.Mesh(e,n),s.position.set(.3*o.gw*(t?1:-1),o.gh*(3.5-p),0),o.menu.add(s)}var e,n,i,s,r,a,l,t,p=0,c=$('style')[0];for(o.gh=(o.H=o.l0p/10)/10,o.gw=o.W/10,o.g=o.pl(100,200),o.ops[0]=o.ops[1]=o.mv,o.ops[2]=o.how,o.ops[4]=o.shwm,o.ops[10]=o.ops[11]=o.cc,o.ops[14]=o.exp,h.ga.add(o.added=o.ob3.clone()),o.im=$('<input type=file accept='+o.ap+'zip onchange=o.imp(this.files)>')[0],o.fi='es'==u.lng?'con el fin de descargar una casa, 1ro debes añadir o subir alguna':'in order to download house, first you must add one or upload your own',o.pfx=o.usrAgnt[/(Chrome|Trident|Firefox)/.exec(o.w.navigator.userAgent)[0]],o.sty+='-'+o.pfx+'-user-select:none}',c?c.innerHTML+='\n'+o.sty:$(o.d.head).append($('<style>').text(o.sty)[0]),o.r.setSize(innerWidth,innerHeight),o.c.position.z=10,r=-o.W/2+o.gw/2,a=o.H/2-o.gh/2,o.st.init(r),e=o.pl(96*o.gw,o.gh),n=new T.MeshBasicMaterial({opacity:0,transparent:!0}),o.s.add(o.tns=new T.Mesh(e,n)),o.tns.position.set(o.tns.left=43*o.gw,a,0),o.tns.c=1,o.tns.right=o.tns.left+10*o.gw,e=o.pl(1.25*o.gw,8.5*o.gh),n=new T.MeshLambertMaterial({transparent:1,opacity:.5,blending:0}),o.menu=new T.Mesh(e,n),o.menu.position.set(4.3*o.gw,-o.gh/4,0),o.menu.c=1,o.s.add(o.menu),e=o.pl(o.gw/2,o.gh);8>p;)t(0),t(1),4==p++&&(s.il=1);$(o.d.body).append(o.r.domElement),o.r.domElement.className='ops '+(u.a?'':'no'),o.is=o.pfx+('webkit'==o.pfx?'Is':'')+o.fs,o.ex=o.pfx+'Cancel'+o.fs,o.rq=o.pfx+'Request'+o.fs,o.tn.id=o.s.children[1].id;for(p in o.ops)o.ops[Number(p)+(2>p?o.left.id:o.tn.id)]=o.ops[p],delete o.ops[p];for(p in o.of)o.Δ[p]=-.62+.15*p,o.txt.lm[p]=2*Math.pow(10,p)-1;o.in=$('<input type=file accept=image/* multiple onchange=o.rb(this.files)>')[0],l=setInterval(o.R,500),o.clear(l,'ops',6e3),o.re=new RegExp(o.left.id+'|'+o.menu.children[0].id+'|'+o.menu.children[2].id+'|'+o.right.id)}},$(o.w).on({click:function(){var e;u.a&&(o.o.id&&(o.ops[o.o.id]?o.ops[o.o.id]():o.at()&&(o.o.parent.id==o.f?o.ntH&&o.zip()&&$.get('js/hs/0.js',function(e){o.ntH(t.s.children.length-1,e)}):(e=o.o.material.map.sourceFile)&&o.add(e,/blob/.test(e)))),!o.st.pnl.position.y&&!o.re.test(o.o.id)&&o.shwm(),o.R())},mousemove:function(t){u.a&&(o.y=t.clientY,(o.x=t.clientX)<1||o.x>o.w.innerWidth-2?!o.app&&o.slide(o.app=1):o.app&&(o.app=0),o.rc(t)&&o.o.id!=o.rst.object.id&&(o.o.id&&(o.at()?(o.o.position.z=0,o.o.material.opacity=.85):o.mc&&((o.mc=o.o.material.color).r=o.pc[0],o.mc.g=o.pc[1],o.mc.b=o.pc[2])),o.o=o.rst.object,o.at()?(o.o.position.z=.125,o.o.material.opacity=1):!o.o.parent.N&&(o.mc=o.o.material.color,o.pc=[o.mc.r,o.mc.g,o.mc.b],o.mc.r=o.mc.g=o.mc.b=0),o.R()))},resize:function(){o.r.setSize(o.w.innerWidth,o.w.innerHeight)}}),o.init()